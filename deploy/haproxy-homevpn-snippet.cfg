# HomeVPN HAProxy integration snippet
# Add these lines to your existing HAProxy frontend configuration:
#
# In the frontend section that handles *.domoteus.com:
#
#     # HomeVPN subdomain routing
#     acl is_homevpn_portal hdr(host) -i portal.domoteus.com
#     use_backend bk_homevpn_portal if is_homevpn_portal
#
#     # Dynamic tunnel routing via map file
#     http-request set-var(req.subdomain) req.hdr(host),lower,regsub(\.domoteus\.com$,,)
#     use_backend %[var(req.subdomain),map(/etc/haproxy/homevpn-subdomains.map)]
#
# Then include the dynamic backends file at the end of your haproxy.cfg:
#
#     # HomeVPN tunnel backends (auto-generated)
#     .include /etc/haproxy/homevpn-backends.cfg
#
# And add the portal backend:
#
# backend bk_homevpn_portal
#     server srv1 127.0.0.1:8080 check
